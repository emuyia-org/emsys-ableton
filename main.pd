#N canvas 0 32 1680 950 12;
#X obj 127 578 midiout;
#X msg 103 507 250;
#X msg 154 507 251;
#X obj 103 459 bng 38 250 50 0 empty empty start> 17 7 0 10 #00ff28 #000000 #e1e1e1;
#X obj 156 472 bng 25 250 50 0 empty empty cont> 17 7 0 10 #191919 #e1e1e1 #e1e1e1;
#X obj 212 459 bng 38 250 50 0 empty empty stop> 17 7 0 10 #ff0035 #000000 #e1e1e1;
#X obj 484 360 counter 0 0 5;
#X obj 622 238 midirealtimein;
#X obj 484 390 sel 0;
#X obj 684 362 bng 25 250 50 0 empty empty >stop 17 7 0 10 #191919 #e1e1e1 #e1e1e1;
#X obj 638 362 bng 25 250 50 0 empty empty >cont 17 7 0 10 #191919 #e1e1e1 #e1e1e1;
#X obj 592 362 bng 25 250 50 0 empty empty >start 17 7 0 10 #191919 #e1e1e1 #e1e1e1;
#X obj 560 296 gate 0, f 12;
#X obj 560 257 tgl 25 0 empty empty clock\ in 17 7 0 10 #191919 #e1e1e1 #e1e1e1 0 1;
#X obj 484 421 counter 0 0 3;
#X obj 484 450 sel 0;
#X obj 484 479 bng 52 50 25 0 empty empty 1/4\ note\ pulse 17 7 0 10 #191919 #6a75e1 #e1e1e1;
#X msg 518 212 1;
#X msg 606 207 0;
#X obj 484 330 sel 248;
#X obj 592 330 sel 250 251 252, f 23;
#X obj 126 386 stripnote;
#X obj 126 425 sel 41 40;
#X obj 126 356 notein;
#X obj 437 167 t, f 8;
#X text 1129 2290 ., f 3;
#X msg 127 546 \$1;
#X obj 56 580 s to-mcl;
#N canvas 1440 0 1600 836 emsys_debug 0;
#X obj 43 95 loadbang;
#X obj 570 38 notein;
#X msg 570 129 note: \$1 \, vel: \$2 \, ch: \$3;
#X obj 570 90 pack f f f;
#X obj 567 173 spigot;
#X obj 42 154 print sys;
#X msg 43 125 welcome;
#X obj 631 167 tgl 20 0 empty empty debug\ MIDI 0 -10 0 12 #000000 #dfdfdf #dfdfdf 0 1;
#X obj 134 86 r to-mcl;
#X obj 134 117 print to-mcl;
#X obj 136 146 r from-mcl;
#X obj 136 177 print from-mcl;
#X obj 570 199 print from-midi;
#X msg 673 53 pgm \$1;
#X obj 269 154 spigot;
#X obj 321 126 tgl 20 0 empty empty debug\ rt\ MIDI 0 -10 0 12 #000000 #dfdfdf #dfdfdf 0 1;
#X obj 256 60 midirealtimein;
#X obj 258 102 sel 248;
#X obj 423 68 sysexin;
#X obj 416 183 print from-sysex;
#X obj 674 21 pgmin;
#X obj 671 88 print from-midi;
#X obj 262 188 print from-midi_rt;
#X obj 422 139 spigot;
#X obj 474 111 tgl 20 0 empty empty debug\ sysex 0 -10 0 12 #000000 #dfdfdf #dfdfdf 0 1;
#X connect 0 0 6 0;
#X connect 1 0 3 0;
#X connect 1 1 3 1;
#X connect 1 2 3 2;
#X connect 2 0 4 0;
#X connect 3 0 2 0;
#X connect 4 0 12 0;
#X connect 6 0 5 0;
#X connect 7 0 4 1;
#X connect 8 0 9 0;
#X connect 10 0 11 0;
#X connect 13 0 21 0;
#X connect 14 0 22 0;
#X connect 15 0 14 1;
#X connect 16 0 17 0;
#X connect 17 1 14 0;
#X connect 18 0 23 0;
#X connect 20 0 13 0;
#X connect 23 0 19 0;
#X connect 24 0 23 1;
#X restore 51 296 pd emsys_debug;
#X obj 466 803 realtime;
#X floatatom 466 884 8 0 0 2 latency\ to\ and\ back - - 0;
#X obj 479 753 onebang;
#X obj 462 717 bng 25 250 50 0 empty empty empty 17 7 0 10 #191919 #ffffff #ffffff;
#X msg 212 507 252;
#X obj 1565 721 pgmout 15;
#X obj 1004 552 bng 52 300 200 0 empty empty load\ beat 17 7 0 10 #00063f #deff00 #e1e1e1;
#X obj 883 577 realtime;
#X obj 884 546 t, f 9;
#X obj 885 851 del;
#X obj 885 887 bng 25 250 50 0 empty empty predicted\ beat\ 1 17 7 0 10 #191919 #e1e1e1 #e1e1e1;
#X obj 883 651 avg;
#X floatatom 883 694 11 0 0 0 avg\ beat\ time - - 16;
#X msg 826 588 clear;
#X obj 1061 400 nbx 4 18 6 64 0 0 empty empty pattern\ beat\ len 0 -8 0 10 #191919 #e1e1e1 #e1e1e1 0 256;
#X obj 1061 425 - 1;
#X msg 885 928 250;
#X text 814 850 mnm transport interrupt signal, f 10;
#X obj 826 1079 midiout;
#X floatatom 885 614 12 0 0 0 rolling\ beat\ time - - 16;
#X obj 852 350 sel 0;
#X obj 826 384 gate 1;
#X obj 821 350 tgl 25 0 empty empty empty 17 7 0 10 #191919 #e1e1e1 #e1e1e1 0 1;
#X obj 828 409 t;
#X msg 875 442 0;
#X obj 828 442 bng 25 250 50 0 empty empty empty 17 7 0 10 #191919 #e1e1e1 #e1e1e1;
#X msg 823 318 1;
#X obj 821 291 loadbang;
#X obj 1004 459 counter 0 0 15;
#X obj 1101 425 - 3;
#X obj 1004 501 sel 13;
#X obj 934 752 sel 1;
#X obj 934 781 bng 25 250 50 0 empty empty downbeat 17 7 0 10 #191919 #e1e1e1 #e1e1e1;
#X obj 466 840 avg;
#X msg 530 804 clear;
#X obj 601 614 loadbang;
#X obj 603 666 tgl 25 0 empty empty calibrate\ midi\ latency 17 7 0 10 #7e0a0e #fffded #e1e1e1 0 1;
#X msg 559 754 0;
#X obj 558 697 sel 1;
#X msg 603 639 1;
#X obj 603 696 metro 500;
#X obj 558 727 delay 5000;
#X obj 466 910 / 2;
#X obj 887 737 -;
#X obj 952 516 sel 0;
#X obj 921 816 onebang, f 14;
#X obj 1565 686 f;
#X msg 943 929 252;
#X obj 1379 441 text get set;
#X floatatom 1379 410 5 0 129 0 - - - 12;
#X obj 1401 510 list;
#X obj 1380 542 list trim;
#X obj 1379 584 route md mnm rep len tin;
#X floatatom 1379 623 5 0 0 0 md\ pgm - - 12;
#X floatatom 1406 651 5 0 0 0 mnm\ pgm - - 12;
#X floatatom 1433 672 5 0 0 0 repeats - - 12;
#X floatatom 1461 710 5 0 0 0 beat\ length - - 12;
#X floatatom 1488 736 5 0 0 0 mnm\ TIn - - 12;
#X obj 1457 477 sel 2;
#X obj 1457 510 bng 25 250 50 0 empty empty schedule\ end 24 12 0 14 #191919 #e1e1e1 #e1e1e1;
#X obj 1347 584 bng 25 250 50 0 empty empty empty 17 7 0 10 #191919 #e1e1e1 #e1e1e1;
#X obj 860 975 f;
#X obj 826 1007 gate 0, f 8;
#X obj 826 966 tgl 25 0 empty empty transport\ interrupt 17 7 0 10 #191919 #e1e1e1 #e1e1e1 0 1;
#X obj 1385 901 counter 0 0 3;
#X obj 1447 858 - 1;
#X obj 1379 1012 bng 25 250 50 0 empty empty empty 17 7 0 10 #191919 #e1e1e1 #e1e1e1;
#X floatatom 1385 937 6 0 0 0 repeat\ no. - - 16;
#X obj 1379 975 sel 3;
#X msg 1381 1043 1;
#X msg 1413 1043 0;
#X obj 1365 1115 gate 0;
#X obj 1658 721 pgmout 16;
#X obj 1658 686 f;
#X obj 1778 639 bng 25 250 50 0 empty empty pgmout\ bang 17 7 0 10 #191919 #e1e1e1 #e1e1e1;
#X obj 1395 280 bng 25 250 50 0 empty empty cont 17 7 0 10 #191919 #e1e1e1 #e1e1e1;
#X obj 1433 280 bng 25 250 50 0 empty empty reset 17 7 0 10 #191919 #e1e1e1 #e1e1e1;
#X obj 1395 377 counter;
#X obj 212 425 r stop;
#X obj 70 425 r start;
#X obj 185 277 keyup;
#X obj 185 328 s start;
#X obj 210 360 s stop;
#X obj 185 301 sel 112 108;
#X obj 1385 864 bng 25 250 50 0 empty empty empty 17 7 0 10 #191919 #e1e1e1 #e1e1e1;
#X obj 1433 323 t;
#X obj 1433 248 r stop;
#X obj 1589 994 bng 25 250 50 0 empty empty empty 17 7 0 10 #191919 #e1e1e1 #e1e1e1;
#X obj 1447 828 f;
#X obj 1501 813 f;
#X obj 1542 813 f;
#X obj 1457 1051 sel 0;
#X obj 1457 1017 change;
#X obj 1457 1155 s stop;
#X obj 1457 1086 onebang;
#X obj 1457 1121 bng 25 250 50 0 empty empty end 17 7 0 10 #191919 #e1e1e1 #e1e1e1;
#X obj 1379 475 list split 2;
#X obj 1327 213 onebang;
#X obj 1778 704 print pgm;
#X obj 1255 326 print advance_set;
#X obj 892 1079 print interrupt;
#X text 1307 974 on last rep;
#X msg 1365 1155 gate=\$1;
#X obj 1443 552 print segment;
#X obj 1283 1012 print last_rep;
#X obj 1440 955 sel 0;
#X obj 1327 249 t b b;
#X obj 1215 153 r stop;
#X msg 1215 180 stop;
#X obj 1553 1060 r stop;
#X msg 1553 1087 stop;
#X obj 782 1043 gate 1;
#X obj 782 1008 tgl 25 0 empty empty empty 17 7 0 10 #191919 #e1e1e1 #e1e1e1 0 1;
#X obj 745 981 loadbang;
#X obj 139 928 text define set;
#X symbolatom 139 750 22 0 0 0 Set\ Name: - - 24;
#X obj 242 928 print;
#X obj 139 679 bng 25 250 50 0 empty empty empty 17 7 0 10 #191919 #e1e1e1 #e1e1e1;
#X obj 139 783 list fromsymbol;
#X obj 302 783 list fromsymbol;
#X obj 139 718 t;
#X obj 139 817 list append;
#X obj 139 851 list tosymbol;
#X msg 139 885 read \$1;
#X obj 212 987 s stop;
#X obj 212 955 bng 25 250 50 0 empty empty empty 17 7 0 10 #191919 #e1e1e1 #e1e1e1;
#X obj 139 641 loadbang;
#X msg 302 753 symbol .mset;
#X obj 1327 183 r load;
#X obj 996 781 r load;
#X obj 649 727 s stop;
#X obj 241 536 s stop_press;
#X obj 30 542 s start_press;
#X obj 462 651 r stop_press;
#X obj 462 675 r start_press;
#X obj 592 399 s mcl_start;
#X obj 638 426 s mcl_cont;
#X obj 207 568 s cont_press;
#X obj 201 389 r cont;
#X obj 684 399 s mcl_stop;
#X obj 478 622 r mcl_start;
#X obj 437 129 r mcl_start;
#X obj 848 238 r mcl_start;
#X obj 975 410 r mcl_start;
#X obj 801 529 r mcl_start;
#X obj 484 542 s mcl_4pulse;
#X obj 975 360 r mcl_4pulse;
#X obj 975 386 r mcl_stop;
#X obj 849 261 r mcl_stop;
#X obj 802 507 r mcl_stop;
#X obj 479 597 r mcl_stop;
#X obj 605 176 r mcl_stop;
#X obj 516 176 r mcl_cont;
#X obj 1004 617 s load;
#X text 975 909 bug: sending an interrupt to both MCL & MnM with stop signal included it is more guaranteed to do a clean interrupt \, but NOT whole MCL is loading a new row, f 19;
#X text 1529 1124 bug: if seg's rep length is 1 then [change] doesn't pick up that it's the end and it never ends, f 29;
#X obj 44 639 r stop_press;
#X text 1510 416 todo: change mset format for pgm messages so that it takes elektron bank format (A01 \, etc.) and converts to pgm, f 24;
#X text 1560 541 note: pgmout needs to be sent separately \, before all the rest of the params. PGM needs to be before the next part \, and the other params need to be immediately before the next part otherwise it will affect the current part's playback., f 40;
#X msg 747 1012 0;
#X text 701 1042 bug: (untested) disabled for now as i dont have mnm with me for further tests, f 12;
#X text 212 630 note: dont write or store within the patch because this seems to create garbled characters that mess up the [list] and [route] parsing. just read and edit files in a separate editor, f 31;
#X text 1271 122 note: only progress set when end of 'repeats' is cleared (onebang) \, then trigger change on load beat, f 30;
#X connect 1 0 26 0;
#X connect 2 0 26 0;
#X connect 3 0 1 0;
#X connect 3 0 161 0;
#X connect 4 0 2 0;
#X connect 4 0 166 0;
#X connect 5 0 33 0;
#X connect 5 0 160 0;
#X connect 6 0 8 0;
#X connect 7 0 12 1;
#X connect 7 0 20 0;
#X connect 8 0 14 0;
#X connect 9 0 168 0;
#X connect 10 0 165 0;
#X connect 11 0 164 0;
#X connect 12 0 19 0;
#X connect 13 0 12 0;
#X connect 14 0 15 0;
#X connect 15 0 16 0;
#X connect 16 0 174 0;
#X connect 17 0 13 0;
#X connect 18 0 13 0;
#X connect 19 0 6 0;
#X connect 20 0 11 0;
#X connect 20 1 10 0;
#X connect 20 2 9 0;
#X connect 21 0 22 0;
#X connect 22 0 3 0;
#X connect 22 1 5 0;
#X connect 23 0 21 0;
#X connect 23 1 21 1;
#X connect 24 0 17 0;
#X connect 24 1 6 2;
#X connect 24 1 14 2;
#X connect 26 0 0 0;
#X connect 26 0 27 0;
#X connect 29 0 62 0;
#X connect 30 0 71 0;
#X connect 31 0 29 1;
#X connect 32 0 31 1;
#X connect 32 0 29 0;
#X connect 33 0 26 0;
#X connect 35 0 182 0;
#X connect 36 0 48 0;
#X connect 37 0 36 0;
#X connect 37 1 36 1;
#X connect 38 0 39 0;
#X connect 39 0 45 0;
#X connect 40 0 41 0;
#X connect 41 0 72 0;
#X connect 42 0 40 0;
#X connect 43 0 44 0;
#X connect 43 0 58 0;
#X connect 44 0 57 4;
#X connect 45 0 90 0;
#X connect 48 0 40 0;
#X connect 49 1 50 1;
#X connect 50 0 52 0;
#X connect 51 0 50 0;
#X connect 52 0 54 0;
#X connect 52 1 53 0;
#X connect 53 0 51 0;
#X connect 54 0 42 0;
#X connect 55 0 51 0;
#X connect 56 0 55 0;
#X connect 57 0 37 0;
#X connect 57 0 49 0;
#X connect 57 0 59 0;
#X connect 57 0 73 0;
#X connect 57 2 60 0;
#X connect 58 0 59 1;
#X connect 59 0 35 0;
#X connect 60 0 61 0;
#X connect 61 0 74 0;
#X connect 62 0 30 0;
#X connect 63 0 62 0;
#X connect 64 0 68 0;
#X connect 65 0 67 0;
#X connect 65 0 69 0;
#X connect 66 0 65 0;
#X connect 67 0 63 0;
#X connect 67 0 70 0;
#X connect 68 0 65 0;
#X connect 69 0 159 0;
#X connect 70 0 66 0;
#X connect 71 0 72 1;
#X connect 72 0 38 1;
#X connect 73 0 42 0;
#X connect 73 0 113 0;
#X connect 74 0 38 0;
#X connect 74 0 76 0;
#X connect 75 0 34 0;
#X connect 76 0 90 0;
#X connect 77 0 125 0;
#X connect 77 1 87 0;
#X connect 78 0 77 0;
#X connect 79 0 125 0;
#X connect 80 0 81 0;
#X connect 80 0 89 0;
#X connect 80 0 132 0;
#X connect 81 0 82 0;
#X connect 81 1 83 0;
#X connect 81 2 84 0;
#X connect 81 3 85 0;
#X connect 81 4 86 0;
#X connect 82 0 75 1;
#X connect 83 0 102 1;
#X connect 84 0 117 1;
#X connect 85 0 118 1;
#X connect 86 0 119 1;
#X connect 87 0 88 0;
#X connect 88 0 123 1;
#X connect 89 0 93 2;
#X connect 90 0 91 1;
#X connect 91 0 140 1;
#X connect 92 0 91 0;
#X connect 93 0 96 0;
#X connect 94 0 93 4;
#X connect 94 0 97 1;
#X connect 95 0 98 0;
#X connect 96 0 97 0;
#X connect 96 0 121 0;
#X connect 96 0 134 0;
#X connect 97 0 95 0;
#X connect 97 0 126 1;
#X connect 97 0 133 0;
#X connect 98 0 100 1;
#X connect 99 0 92 0;
#X connect 100 0 92 0;
#X connect 100 0 131 0;
#X connect 102 0 101 0;
#X connect 103 0 75 0;
#X connect 103 0 102 0;
#X connect 103 0 127 0;
#X connect 104 0 106 0;
#X connect 104 0 128 0;
#X connect 105 0 114 0;
#X connect 106 0 78 0;
#X connect 107 0 5 0;
#X connect 108 0 3 0;
#X connect 109 0 112 0;
#X connect 112 0 110 0;
#X connect 112 1 111 0;
#X connect 113 0 93 0;
#X connect 114 0 103 0;
#X connect 114 1 106 3;
#X connect 115 0 105 0;
#X connect 116 0 117 0;
#X connect 116 0 118 0;
#X connect 116 0 119 0;
#X connect 116 0 99 0;
#X connect 117 0 94 0;
#X connect 118 0 43 0;
#X connect 119 0 100 0;
#X connect 120 0 123 0;
#X connect 121 0 120 0;
#X connect 123 0 124 0;
#X connect 124 0 122 0;
#X connect 125 0 80 0;
#X connect 125 1 79 0;
#X connect 126 0 135 0;
#X connect 131 0 129 0;
#X connect 134 0 116 0;
#X connect 135 0 103 0;
#X connect 135 1 104 0;
#X connect 136 0 137 0;
#X connect 137 0 126 0;
#X connect 138 0 139 0;
#X connect 139 0 123 0;
#X connect 140 0 47 0;
#X connect 140 0 129 0;
#X connect 141 0 140 0;
#X connect 142 0 188 0;
#X connect 143 1 154 0;
#X connect 144 0 147 0;
#X connect 146 0 149 0;
#X connect 147 0 150 0;
#X connect 148 0 150 1;
#X connect 149 0 144 0;
#X connect 149 1 156 0;
#X connect 150 0 151 0;
#X connect 151 0 152 0;
#X connect 152 0 145 0;
#X connect 152 0 143 0;
#X connect 154 0 153 0;
#X connect 155 0 146 0;
#X connect 156 0 148 0;
#X connect 157 0 126 0;
#X connect 158 0 74 1;
#X connect 162 0 32 0;
#X connect 163 0 32 0;
#X connect 167 0 4 0;
#X connect 169 0 31 0;
#X connect 170 0 24 0;
#X connect 171 0 55 0;
#X connect 172 0 57 2;
#X connect 173 0 42 0;
#X connect 175 0 57 0;
#X connect 176 0 57 2;
#X connect 177 0 55 0;
#X connect 178 0 42 0;
#X connect 179 0 31 0;
#X connect 180 0 18 0;
#X connect 181 0 17 0;
#X connect 185 0 146 0;
#X connect 188 0 141 0;

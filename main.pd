#N canvas 1440 900 1920 978 12;
#X obj 923 28 loadbang;
#X obj 468 731 midiout;
#X obj 515 574 bng 65 250 50 0 empty empty A01 17 7 0 10 #191919 #e1e1e1 #e1e1e1;
#X obj 609 573 bng 65 250 50 0 empty empty A04 17 7 0 10 #191919 #e1e1e1 #e1e1e1;
#X msg 621 702 4;
#X msg 528 702 1;
#X obj 515 655 t;
#X obj 609 654 t;
#X text 515 546 pattern interrupt test;
#X obj 1069 73 notein;
#X msg 1069 164 note: \$1 \, vel: \$2 \, ch: \$3;
#X obj 1069 125 pack f f f;
#X obj 110 365 midiout;
#X msg 86 294 250;
#X obj 630 124 knob 50 30 300 0 33 empty empty #191919 #696969 #e1e1e1 1 0 0 0 0 270 0 0 120;
#X msg 195 294 252;
#X msg 137 294 251;
#X obj 86 259 bng 25 250 50 0 empty empty start> 17 7 0 10 #191919 #e1e1e1 #e1e1e1;
#X obj 139 259 bng 25 250 50 0 empty empty cont> 17 7 0 10 #191919 #e1e1e1 #e1e1e1;
#X obj 195 259 bng 25 250 50 0 empty empty stop> 17 7 0 10 #191919 #e1e1e1 #e1e1e1;
#X floatatom 637 202 11 0 0 0 tempo - - 16;
#X msg 476 692 250;
#X obj 333 246 counter 0 0 5;
#X obj 458 128 midirealtimein;
#X obj 333 281 sel 0;
#X obj 333 314 bng 25 250 50 0 empty empty >tick 17 7 0 10 #191919 #e1e1e1 #e1e1e1;
#X obj 492 246 bng 25 250 50 0 empty empty >stop 17 7 0 10 #191919 #e1e1e1 #e1e1e1;
#X obj 460 246 bng 25 250 50 0 empty empty >cont 17 7 0 10 #191919 #e1e1e1 #e1e1e1;
#X obj 428 246 bng 25 250 50 0 empty empty >start 17 7 0 10 #191919 #e1e1e1 #e1e1e1;
#X obj 636 417 midiout;
#X obj 636 282 expr round($f1 * 24);
#X obj 396 167 gate 0, f 12;
#X obj 396 128 tgl 25 0 empty empty clock\ in 17 7 0 10 #191919 #e1e1e1 #e1e1e1 0 1;
#X obj 636 316 expr ($f1 >> 7) & 0x7F;
#X obj 812 318 expr $f1 & 0x7F;
#X text 700 405 sysex IN to MD requires MCL: USB FWD: 1, f 22;
#X obj 230 314 counter 0 0 3;
#X obj 230 343 sel 0;
#X obj 230 372 bng 52 50 25 0 empty empty 1/4\ note\ pulse 17 7 0 10 #191919 #e1e1e1 #e1e1e1;
#N canvas 733 172 450 300 midi_throttle 0;
#X obj 91 128 change;
#X obj 91 352 f, f 11;
#X obj 91 396 change;
#X obj 91 299 onebang, f 25;
#X obj 189 223 counter 0 0 1;
#X obj 189 255 sel 1;
#X obj 91 160 t b f;
#X obj 167 122 loadbang;
#X msg 167 151 1;
#X obj 163 180 metro 100;
#X obj 91 51 inlet;
#X obj 91 434 outlet;
#X connect 0 0 6 0;
#X connect 1 0 2 0;
#X connect 2 0 11 0;
#X connect 3 0 1 0;
#X connect 4 0 5 0;
#X connect 5 0 3 1;
#X connect 6 0 3 0;
#X connect 6 1 1 1;
#X connect 7 0 8 0;
#X connect 8 0 9 0;
#X connect 9 0 1 0;
#X connect 9 0 4 0;
#X connect 10 0 0 0;
#X restore 636 243 pd midi_throttle;
#X msg 636 383 240 0 32 60 2 0 97 \$1 \$2 247;
#X obj 637 352 pack f f;
#X obj 372 489 dac~;
#X obj 410 401 line;
#X obj 336 428 *~ 0;
#X msg 376 371 0.1 \, 0 150;
#X msg 463 326 set 0;
#X msg 428 326 1;
#X msg 487 288 0;
#X obj 330 207 sel 248;
#X obj 428 201 sel 250 251 252;
#X obj 109 173 stripnote;
#X obj 109 212 sel 41 40;
#X text 71 117 from minilab (play/stop pads);
#X obj 109 143 notein;
#X obj 405 445 tgl 20 0 empty empty test\ blip 0 -10 0 12 #000000 #ffffff #bbbbbb 0 1;
#X obj 358 457 *~ 0;
#X obj 331 398 saw~ 500;
#X obj 429 288 t, f 5;
#X text 926 850 ., f 3;
#X text 695 144 todo: read current tempo to keep param updated;
#X msg 529 740 \$1;
#X msg 786 240 tempo \$1;
#X msg 110 333 \$1;
#X obj 1066 208 spigot;
#X obj 922 87 print sys;
#X msg 923 58 welcome;
#X obj 1130 202 tgl 20 0 empty empty debug\ MIDI 0 -10 0 12 #000000 #dfdfdf #dfdfdf 0 1;
#X obj 39 367 s to-mcl;
#X obj 791 272 s to-mcl;
#X obj 964 177 r to-mcl;
#X obj 964 208 print to-mcl;
#X obj 966 237 r from-mcl;
#X obj 966 268 print from-mcl;
#X obj 1069 234 print from-midi;
#X obj 616 777 s to-mcl;
#X msg 615 748 pgm \$1;
#X text 687 553 PGM followed by immediate play signal works OK on MD/MnM standalone \, but MCL requires a gap... therefore \, this should probably only be sent to MnM \, separately \, when MCL performs a switchover. the PGM out from MCL to MnM should be intercepted \, and paired with a 250 signal to interrupt the MnM after the pattern changes. This would also serve to keep the MnM in sync with MCL more reliably (hopefully). testing will be needed to ensure this works \, but without the MnM with me right now that might be a little hard. I can only program it in concept at the moment.;
#X msg 1197 516 pgm \$1;
#X obj 1195 551 s from-mcl;
#X obj 1215 369 print from-midi-raw;
#X obj 1222 335 spigot;
#X obj 1274 307 tgl 20 0 empty empty debug\ MIDI 0 -10 0 12 #000000 #dfdfdf #dfdfdf 0 1;
#X obj 1209 241 midirealtimein;
#X obj 1211 283 sel 248;
#X obj 1362 253 sysexin;
#X obj 1366 304 print from-sysex;
#X obj 524 774 pgmout 15;
#X text 473 799 assumes MCL PGM IN is set to ch15;
#X obj 1198 484 pgmin;
#X text 720 748 so I *can* use port 2 to get PGM from MCL \, but currently getting PGM from USB is not available. however \, if I set MIDI 1 FWD to USB \, I get sysex messages in - which gives me the idea that I might be able to send sysex messages to do PGM interrupts to the MnM *instead of* intercepting PGM messages from MCL to MnM via Port 2 todo: check if there's a way to send sysex to MD to change patterns \, and test if it plays nice with MCL when I send it from Pd.;
#X connect 0 0 66 0;
#X connect 2 0 6 0;
#X connect 3 0 7 0;
#X connect 4 0 61 0;
#X connect 5 0 61 0;
#X connect 6 0 21 0;
#X connect 6 1 5 0;
#X connect 7 0 21 0;
#X connect 7 1 4 0;
#X connect 9 0 11 0;
#X connect 9 1 11 1;
#X connect 9 2 11 2;
#X connect 10 0 64 0;
#X connect 11 0 10 0;
#X connect 13 0 63 0;
#X connect 14 0 20 0;
#X connect 15 0 63 0;
#X connect 16 0 63 0;
#X connect 17 0 13 0;
#X connect 18 0 16 0;
#X connect 19 0 15 0;
#X connect 20 0 39 0;
#X connect 21 0 1 0;
#X connect 22 0 24 0;
#X connect 23 0 31 1;
#X connect 23 0 50 0;
#X connect 24 0 25 0;
#X connect 24 0 36 0;
#X connect 26 0 48 0;
#X connect 27 0 47 0;
#X connect 28 0 58 0;
#X connect 30 0 33 0;
#X connect 30 0 34 0;
#X connect 31 0 49 0;
#X connect 32 0 31 0;
#X connect 33 0 41 0;
#X connect 34 0 41 1;
#X connect 36 0 37 0;
#X connect 37 0 38 0;
#X connect 38 0 45 0;
#X connect 39 0 30 0;
#X connect 39 0 62 0;
#X connect 40 0 29 0;
#X connect 41 0 40 0;
#X connect 43 0 44 1;
#X connect 44 0 56 0;
#X connect 45 0 43 0;
#X connect 46 0 22 0;
#X connect 46 0 36 0;
#X connect 47 0 32 0;
#X connect 48 0 32 0;
#X connect 49 0 22 0;
#X connect 50 0 28 0;
#X connect 50 1 27 0;
#X connect 50 2 26 0;
#X connect 51 0 52 0;
#X connect 52 0 17 0;
#X connect 52 1 19 0;
#X connect 54 0 51 0;
#X connect 54 1 51 1;
#X connect 55 0 56 1;
#X connect 56 0 42 0;
#X connect 56 0 42 1;
#X connect 57 0 44 0;
#X connect 58 0 47 0;
#X connect 58 1 46 0;
#X connect 61 0 76 0;
#X connect 61 0 87 0;
#X connect 62 0 69 0;
#X connect 63 0 12 0;
#X connect 63 0 68 0;
#X connect 64 0 74 0;
#X connect 66 0 65 0;
#X connect 67 0 64 1;
#X connect 70 0 71 0;
#X connect 72 0 73 0;
#X connect 76 0 75 0;
#X connect 78 0 79 0;
#X connect 81 0 80 0;
#X connect 82 0 81 1;
#X connect 83 0 84 0;
#X connect 84 1 81 0;
#X connect 85 0 86 0;
#X connect 89 0 78 0;

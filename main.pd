#N canvas 0 32 1680 950 12;
#X obj 97 434 midiout;
#X msg 73 363 250;
#X msg 124 363 251;
#X obj 73 315 bng 38 250 50 0 empty empty start> 17 7 0 10 #00ff28 #000000 #e1e1e1;
#X obj 126 328 bng 25 250 50 0 empty empty cont> 17 7 0 10 #191919 #e1e1e1 #e1e1e1;
#X obj 182 315 bng 38 250 50 0 empty empty stop> 17 7 0 10 #ff0035 #000000 #e1e1e1;
#X obj 439 356 counter 0 0 5;
#X obj 624 198 midirealtimein;
#X obj 439 391 sel 0;
#X obj 712 334 bng 25 250 50 0 empty empty >stop 17 7 0 10 #191919 #e1e1e1 #e1e1e1;
#X obj 660 334 bng 25 250 50 0 empty empty >cont 17 7 0 10 #191919 #e1e1e1 #e1e1e1;
#X obj 599 335 bng 25 250 50 0 empty empty >start 17 7 0 10 #191919 #e1e1e1 #e1e1e1;
#X obj 562 256 gate 0, f 12;
#X obj 562 217 tgl 25 0 empty empty clock\ in 17 7 0 10 #191919 #e1e1e1 #e1e1e1 0 1;
#X obj 329 245 counter 0 0 3;
#X obj 329 274 sel 0;
#X obj 329 303 bng 52 50 25 0 empty empty 1/4\ note\ pulse 17 7 0 10 #191919 #6a75e1 #e1e1e1;
#X msg 388 180 set 0;
#X msg 520 172 1;
#X msg 563 172 0;
#X obj 436 317 sel 248;
#X obj 594 290 sel 250 251 252;
#X obj 96 242 stripnote;
#X obj 96 281 sel 41 40;
#X text 58 186 from minilab (play/stop pads);
#X obj 96 212 notein;
#X obj 439 121 t, f 8;
#X text 1099 2146 ., f 3;
#X msg 97 402 \$1;
#X obj 26 436 s to-mcl;
#N canvas 1440 0 1600 836 emsys_debug 0;
#X obj 43 95 loadbang;
#X obj 570 38 notein;
#X msg 570 129 note: \$1 \, vel: \$2 \, ch: \$3;
#X obj 570 90 pack f f f;
#X obj 567 173 spigot;
#X obj 42 154 print sys;
#X msg 43 125 welcome;
#X obj 631 167 tgl 20 0 empty empty debug\ MIDI 0 -10 0 12 #000000 #dfdfdf #dfdfdf 0 1;
#X obj 134 86 r to-mcl;
#X obj 134 117 print to-mcl;
#X obj 136 146 r from-mcl;
#X obj 136 177 print from-mcl;
#X obj 570 199 print from-midi;
#X msg 673 53 pgm \$1;
#X obj 269 154 spigot;
#X obj 321 126 tgl 20 0 empty empty debug\ rt\ MIDI 0 -10 0 12 #000000 #dfdfdf #dfdfdf 0 1;
#X obj 256 60 midirealtimein;
#X obj 258 102 sel 248;
#X obj 423 68 sysexin;
#X obj 416 183 print from-sysex;
#X obj 674 21 pgmin;
#X obj 671 88 print from-midi;
#X obj 262 188 print from-midi_rt;
#X obj 422 139 spigot;
#X obj 474 111 tgl 20 0 empty empty debug\ sysex 0 -10 0 12 #000000 #dfdfdf #dfdfdf 0 1;
#X connect 0 0 6 0;
#X connect 1 0 3 0;
#X connect 1 1 3 1;
#X connect 1 2 3 2;
#X connect 2 0 4 0;
#X connect 3 0 2 0;
#X connect 4 0 12 0;
#X connect 6 0 5 0;
#X connect 7 0 4 1;
#X connect 8 0 9 0;
#X connect 10 0 11 0;
#X connect 13 0 21 0;
#X connect 14 0 22 0;
#X connect 15 0 14 1;
#X connect 16 0 17 0;
#X connect 17 1 14 0;
#X connect 18 0 23 0;
#X connect 20 0 13 0;
#X connect 23 0 19 0;
#X connect 24 0 23 1;
#X restore 56 139 pd emsys_debug;
#X obj 43 626 realtime;
#X floatatom 43 707 8 0 0 2 latency\ to\ and\ back - - 0;
#X obj 56 576 onebang;
#X obj 39 540 bng 25 250 50 0 empty empty empty 17 7 0 10 #191919 #ffffff #ffffff;
#X msg 182 363 252;
#X obj 1518 582 pgmout 15;
#X text 1046 341 exploring the case for Pd PGM out to MCL & MnM \, with no PGM out from MCL (no port 2 MIDI interface required), f 22;
#X obj 974 392 bng 52 300 200 0 empty empty load\ beat 17 7 0 10 #00063f #deff00 #e1e1e1;
#X obj 853 433 realtime;
#X obj 854 402 t, f 9;
#X obj 855 707 del;
#X obj 855 743 bng 25 250 50 0 empty empty predicted\ beat\ 1 17 7 0 10 #191919 #e1e1e1 #e1e1e1;
#X obj 853 507 avg;
#X floatatom 853 550 11 0 0 0 avg\ beat\ time - - 16;
#X msg 796 444 clear;
#X obj 1031 256 nbx 4 18 6 64 0 0 empty empty pattern\ beat\ len 0 -8 0 10 #191919 #e1e1e1 #e1e1e1 0 256;
#X obj 1031 281 - 1;
#X text 1097 186 for unusual time sigs and different tempo patterns \, there ought to be a setting in the txt table which describes the number of beats a pattern lasts for \, in order to determine the correct location of the downbeat \, and then assign that to the max val of this counter & the sel, f 29;
#X msg 855 784 250;
#X text 784 706 mnm transport interrupt signal, f 10;
#X obj 796 935 midiout;
#X floatatom 855 470 12 0 0 0 rolling\ beat\ time - - 16;
#X obj 834 165 sel 0;
#X obj 808 199 gate 1;
#X obj 803 165 tgl 25 0 empty empty empty 17 7 0 10 #191919 #e1e1e1 #e1e1e1 0 1;
#X obj 810 224 t;
#X msg 857 257 0;
#X obj 810 257 bng 25 250 50 0 empty empty empty 17 7 0 10 #191919 #e1e1e1 #e1e1e1;
#X msg 805 133 1;
#X obj 803 106 loadbang;
#X text 877 118 only bang once on step 2 \, reset on full stop, f 8;
#X obj 974 315 counter 0 0 15;
#X obj 1071 281 - 3;
#X obj 974 357 sel 13;
#X obj 904 608 sel 1;
#X obj 904 637 bng 25 250 50 0 empty empty downbeat 17 7 0 10 #191919 #e1e1e1 #e1e1e1;
#X obj 43 663 avg;
#X msg 107 627 clear;
#X obj 178 437 loadbang;
#X obj 180 489 tgl 25 0 empty empty calibrate\ midi\ latency 17 7 0 10 #7e0a0e #fffded #e1e1e1 0 1;
#X msg 136 577 0;
#X obj 135 520 sel 1;
#X msg 180 462 1;
#X obj 180 519 metro 500;
#X obj 135 550 delay 5000;
#X obj 43 733 / 2;
#X obj 857 593 -;
#X obj 922 372 sel 0;
#X obj 891 672 onebang;
#X obj 1518 547 f;
#X msg 913 785 252;
#X obj 1592 357 text define -k set;
#A set md 33 mnm 36 rep 3 len 16 tin 1 \; md 34 mnm 36 rep 3 len 16 tin 1 \; md 35 mnm 36 rep 2 len 16 tin 0 \;;
#X msg 1565 320 read test.txt;
#X msg 1565 262 click;
#X msg 1565 291 write test.txt;
#X obj 1349 297 text get set;
#X floatatom 1349 266 5 0 129 0 - - - 12;
#X obj 1371 366 list;
#X obj 1350 398 list trim;
#X obj 1349 440 route md mnm rep len tin;
#X floatatom 1349 479 5 0 0 0 md\ pgm - - 12;
#X floatatom 1376 507 5 0 0 0 mnm\ pgm - - 12;
#X floatatom 1403 528 5 0 0 0 repeats - - 12;
#X floatatom 1431 566 5 0 0 0 beat\ length - - 12;
#X floatatom 1458 592 5 0 0 0 mnm\ TIn - - 12;
#X obj 1427 333 sel 2;
#X obj 1427 366 bng 25 250 50 0 empty empty schedule\ end 24 12 0 14 #191919 #e1e1e1 #e1e1e1;
#X obj 1317 440 bng 25 250 50 0 empty empty empty 17 7 0 10 #191919 #e1e1e1 #e1e1e1;
#X obj 830 831 f;
#X text 1002 151 for now \, minimum val is 6 because of the load beat calculation, f 15;
#X obj 796 863 gate 0, f 8;
#X obj 796 822 tgl 25 0 empty empty transport\ interrupt 17 7 0 10 #191919 #e1e1e1 #e1e1e1 0 1;
#X obj 1355 757 counter 0 0 3;
#X obj 1417 714 - 1;
#X obj 1360 930 bng 25 250 50 0 empty empty empty 17 7 0 10 #191919 #e1e1e1 #e1e1e1;
#X floatatom 1355 793 6 0 0 0 repeat\ no. - - 16;
#X obj 1349 831 sel 3;
#X msg 1362 970 1;
#X msg 1394 968 0;
#X obj 1333 1039 gate 0;
#X obj 1611 582 pgmout 16;
#X obj 1611 547 f;
#X obj 1611 500 bng 25 250 50 0 empty empty pgmout\ bang 17 7 0 10 #191919 #e1e1e1 #e1e1e1;
#X obj 1365 136 bng 25 250 50 0 empty empty cont 17 7 0 10 #191919 #e1e1e1 #e1e1e1;
#X obj 1403 136 bng 25 250 50 0 empty empty reset 17 7 0 10 #191919 #e1e1e1 #e1e1e1;
#X obj 1365 233 counter;
#X obj 182 281 r stop;
#X obj 30 281 r start;
#X obj 180 77 keyup;
#X obj 180 128 s start;
#X obj 205 160 s stop;
#X obj 180 101 sel 112 108;
#X obj 1355 720 bng 25 250 50 0 empty empty empty 17 7 0 10 #191919 #e1e1e1 #e1e1e1;
#X obj 1403 179 t;
#X obj 1403 104 r stop;
#X obj 1534 862 bng 25 250 50 0 empty empty empty 17 7 0 10 #191919 #e1e1e1 #e1e1e1;
#X text 1530 397 pgmout needs to be sent separately \, before all the rest of the params. PGM needs to be before the next part \, and the other params need to be immediately before the next part otherwise it will affect the current part's playback., f 40;
#X obj 1417 684 f;
#X obj 1471 669 f;
#X obj 1512 669 f;
#X obj 1427 907 sel 0;
#X obj 1427 873 change;
#X obj 1427 1011 s stop;
#X obj 1427 942 onebang;
#X obj 1427 977 bng 25 250 50 0 empty empty end 17 7 0 10 #191919 #e1e1e1 #e1e1e1;
#X obj 1349 331 list split 2;
#X obj 1297 69 onebang;
#X obj 1731 565 print pgm;
#X obj 1225 182 print advance_set;
#X text 1241 8 only progress set when end of 'repeats' is cleared (onebang) \, then trigger change on load beat, f 30;
#X obj 862 935 print interrupt;
#X text 1277 830 on last rep;
#X msg 1243 1055 gate=\$1;
#X obj 1212 535 print segment;
#X obj 1263 870 print last_rep;
#X obj 1410 811 sel 0;
#X text 945 765 sending an interrupt to both MCL & MnM with stop signal included it is more guaranteed to do a clean interrupt \, but NOT whole MCL is loading a new row, f 19;
#X text 1624 201 there is a bug in text where bogus characters appear and prevent [list] and [route] from recognising the integers. idk how to deal with this currently. my suspicion is that it happens when you save or load the file physically, f 49;
#X obj 1297 105 t b b;
#X obj 1185 9 r stop;
#X msg 1185 36 stop;
#X obj 1530 935 r stop;
#X msg 1530 962 stop;
#X obj 752 899 gate 1;
#X obj 752 864 tgl 25 0 empty empty empty 17 7 0 10 #191919 #e1e1e1 #e1e1e1 0 1;
#X obj 715 837 loadbang;
#X msg 717 868 1;
#X text 671 898 disabled for now as i dont have mnm with me, f 12;
#X connect 1 0 28 0;
#X connect 2 0 28 0;
#X connect 3 0 1 0;
#X connect 3 0 34 0;
#X connect 4 0 2 0;
#X connect 5 0 35 0;
#X connect 5 0 34 0;
#X connect 6 0 8 0;
#X connect 7 0 12 1;
#X connect 7 0 21 0;
#X connect 8 0 14 0;
#X connect 9 0 19 0;
#X connect 9 0 45 0;
#X connect 9 0 59 0;
#X connect 9 0 62 2;
#X connect 9 0 33 0;
#X connect 10 0 18 0;
#X connect 11 0 26 0;
#X connect 11 0 33 0;
#X connect 11 0 45 0;
#X connect 11 0 62 2;
#X connect 11 0 59 0;
#X connect 12 0 20 0;
#X connect 13 0 12 0;
#X connect 14 0 15 0;
#X connect 15 0 16 0;
#X connect 16 0 62 0;
#X connect 17 0 6 0;
#X connect 18 0 13 0;
#X connect 19 0 13 0;
#X connect 20 0 6 0;
#X connect 21 0 11 0;
#X connect 21 1 10 0;
#X connect 21 2 9 0;
#X connect 22 0 23 0;
#X connect 23 0 3 0;
#X connect 23 1 5 0;
#X connect 25 0 22 0;
#X connect 25 1 22 1;
#X connect 26 0 18 0;
#X connect 26 1 17 0;
#X connect 26 1 6 2;
#X connect 26 1 14 2;
#X connect 28 0 0 0;
#X connect 28 0 29 0;
#X connect 31 0 67 0;
#X connect 32 0 76 0;
#X connect 33 0 31 1;
#X connect 34 0 33 1;
#X connect 34 0 31 0;
#X connect 35 0 28 0;
#X connect 38 0 79 1;
#X connect 38 0 137 0;
#X connect 39 0 52 0;
#X connect 40 0 39 0;
#X connect 40 1 39 1;
#X connect 41 0 42 0;
#X connect 42 0 49 0;
#X connect 43 0 44 0;
#X connect 44 0 77 0;
#X connect 45 0 43 0;
#X connect 46 0 47 0;
#X connect 46 0 63 0;
#X connect 47 0 62 4;
#X connect 49 0 99 0;
#X connect 52 0 43 0;
#X connect 53 1 54 1;
#X connect 54 0 56 0;
#X connect 55 0 54 0;
#X connect 56 0 58 0;
#X connect 56 1 57 0;
#X connect 57 0 55 0;
#X connect 58 0 45 0;
#X connect 59 0 55 0;
#X connect 60 0 59 0;
#X connect 62 0 40 0;
#X connect 62 0 53 0;
#X connect 62 0 64 0;
#X connect 62 0 78 0;
#X connect 62 2 65 0;
#X connect 63 0 64 1;
#X connect 64 0 38 0;
#X connect 65 0 66 0;
#X connect 66 0 79 0;
#X connect 67 0 32 0;
#X connect 68 0 67 0;
#X connect 69 0 73 0;
#X connect 70 0 72 0;
#X connect 70 0 74 0;
#X connect 71 0 70 0;
#X connect 72 0 68 0;
#X connect 72 0 75 0;
#X connect 73 0 70 0;
#X connect 74 0 5 0;
#X connect 75 0 71 0;
#X connect 76 0 77 1;
#X connect 77 0 41 1;
#X connect 78 0 45 0;
#X connect 78 0 123 0;
#X connect 79 0 41 0;
#X connect 79 0 81 0;
#X connect 80 0 36 0;
#X connect 81 0 99 0;
#X connect 83 0 82 0;
#X connect 84 0 82 0;
#X connect 85 0 82 0;
#X connect 86 0 136 0;
#X connect 86 1 96 0;
#X connect 87 0 86 0;
#X connect 88 0 136 0;
#X connect 89 0 90 0;
#X connect 89 0 98 0;
#X connect 89 0 144 0;
#X connect 90 0 91 0;
#X connect 90 1 92 0;
#X connect 90 2 93 0;
#X connect 90 3 94 0;
#X connect 90 4 95 0;
#X connect 91 0 80 1;
#X connect 92 0 112 1;
#X connect 93 0 128 1;
#X connect 94 0 129 1;
#X connect 95 0 130 1;
#X connect 96 0 97 0;
#X connect 97 0 134 1;
#X connect 98 0 103 2;
#X connect 99 0 101 1;
#X connect 101 0 154 1;
#X connect 102 0 101 0;
#X connect 103 0 106 0;
#X connect 104 0 103 4;
#X connect 104 0 107 1;
#X connect 105 0 108 0;
#X connect 106 0 107 0;
#X connect 106 0 132 0;
#X connect 106 0 146 0;
#X connect 107 0 105 0;
#X connect 107 0 137 1;
#X connect 107 0 145 0;
#X connect 108 0 110 1;
#X connect 109 0 102 0;
#X connect 110 0 102 0;
#X connect 110 0 143 0;
#X connect 112 0 111 0;
#X connect 113 0 80 0;
#X connect 113 0 112 0;
#X connect 113 0 138 0;
#X connect 114 0 116 0;
#X connect 114 0 139 0;
#X connect 115 0 124 0;
#X connect 116 0 87 0;
#X connect 117 0 5 0;
#X connect 118 0 3 0;
#X connect 119 0 122 0;
#X connect 122 0 120 0;
#X connect 122 1 121 0;
#X connect 123 0 103 0;
#X connect 124 0 113 0;
#X connect 124 1 116 3;
#X connect 125 0 115 0;
#X connect 126 0 128 0;
#X connect 126 0 129 0;
#X connect 126 0 130 0;
#X connect 126 0 109 0;
#X connect 128 0 104 0;
#X connect 129 0 46 0;
#X connect 130 0 110 0;
#X connect 131 0 134 0;
#X connect 132 0 131 0;
#X connect 134 0 135 0;
#X connect 135 0 133 0;
#X connect 136 0 89 0;
#X connect 136 1 88 0;
#X connect 137 0 149 0;
#X connect 143 0 141 0;
#X connect 146 0 126 0;
#X connect 149 0 113 0;
#X connect 149 1 114 0;
#X connect 150 0 151 0;
#X connect 151 0 137 0;
#X connect 152 0 153 0;
#X connect 153 0 134 0;
#X connect 154 0 51 0;
#X connect 154 0 141 0;
#X connect 155 0 154 0;
#X connect 156 0 157 0;
#X connect 157 0 155 0;
